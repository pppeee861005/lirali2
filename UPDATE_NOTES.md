# 🎯 利娜莉管家系統 v2.0 - 更新說明

## 📋 新增功能概覽

### 1. 記憶更新功能 (`update_memory`)
**用途:** 修改已存在的記憶內容或標籤

**使用場景:**
- 「更新我之前記的咖啡喜好」
- 「改一下工作計畫的內容」
- 「幫這個記憶加上新標籤」

**參數:**
- `topic`: 記憶所在的主題
- `title`: 要更新的記憶標題
- `new_content`: 新的內容(可選)
- `new_tags`: 新的標籤陣列(可選)

**範例:**
```python
memory_store.update(
    topic="飲食",
    title="咖啡喜好",
    new_content="喜歡拿鐵,不加糖,少冰",
    new_tags=["#飲食", "#咖啡", "#偏好"]
)
```

---

### 2. 記憶刪除功能 (`delete_memory`)
**用途:** 刪除不再需要的記憶

**使用場景:**
- 「刪掉旅遊計畫這個主題」
- 「移除工作主題下的舊專案記錄」

**參數:**
- `topic`: 要刪除的主題
- `title`: 特定標題(可選,不提供則刪除整個主題)

**範例:**
```python
# 刪除特定記憶
memory_store.delete(topic="工作", title="舊專案")

# 刪除整個主題
memory_store.delete(topic="過期計畫")
```

---

### 3. 主題列表功能 (`list_topics`)
**用途:** 查看所有記憶主題及其統計資訊

**使用場景:**
- 「我記了哪些東西?」
- 「列出所有主題」
- 「給我看看記憶分類」

**返回資訊:**
- 主題名稱
- 記憶數量
- 相關標籤
- 最近活動時間

**範例輸出:**
```json
{
  "status": "ok",
  "total_topics": 5,
  "topics": [
    {
      "topic": "工作",
      "count": 12,
      "tags": ["#專案", "#會議", "#deadline"],
      "latest_activity": "2025-10-22T10:30:00"
    },
    {
      "topic": "生活",
      "count": 8,
      "tags": ["#購物", "#運動", "#飲食"],
      "latest_activity": "2025-10-21T18:45:00"
    }
  ]
}
```

---

### 4. 統計資訊功能 (`get_statistics`)
**用途:** 獲取記憶庫的整體分析數據

**使用場景:**
- 「統計一下我的記憶」
- 「給我看整體資訊」
- 「我記了多少東西?」

**返回資訊:**
- 總記憶數
- 總主題數
- 前 10 名熱門標籤

**範例輸出:**
```json
{
  "status": "ok",
  "total_memories": 45,
  "total_topics": 7,
  "top_tags": [
    {"tag": "#工作", "count": 15},
    {"tag": "#想法", "count": 12},
    {"tag": "#生活", "count": 10}
  ]
}
```

---

### 5. 主題摘要功能 (`summarize_topic`)
**用途:** 自動整理某主題的所有記憶並生成摘要

**使用場景:**
- 「幫我整理一下工作主題的記憶」
- 「總結我記的旅遊相關資訊」
- 「給我一份生活主題的摘要」

**工作流程:**
1. 取得主題下的所有記憶資料
2. 由 AI 分析並生成人類可讀的摘要
3. 包含時間範圍、重點項目、關鍵標籤等

**AI 會自動生成類似這樣的摘要:**
```
📊 工作主題摘要

記憶總數: 12 筆
時間範圍: 2025-09-15 ~ 2025-10-22

🔑 重點內容:
• 專案 A 的 deadline 是 11/15,需要準備簡報
• 每週一上午 10:00 固定會議
• 新客戶 B 公司的聯絡窗口是張經理

🏷 常用標籤: #專案 #會議 #deadline #客戶

💡 建議: 
接近月底了,建議檢視 11 月的專案進度和會議安排~
```

---

## 🔧 技術改進

### 1. 增強的搜尋功能
- 新增 `tags` 參數支援按標籤過濾
- 改進搜尋演算法,支援多條件組合查詢

### 2. 記憶項目追蹤
- 新增 `updated_at` 欄位記錄更新時間
- 方便追蹤記憶的修改歷史

### 3. 更好的資料結構
- 主題按最近活動時間排序
- 統計功能提供熱門標籤分析

---

## 💬 實際對話範例

### 場景 1: 查看所有記憶分類
```
你: 我記了哪些東西?
管家: 好的豪力殿下,讓我幫您看一下~ 您目前有 5 個主題:

📁 工作 (12筆) - 最近更新: 今天 10:30
   標籤: #專案、#會議、#deadline

📁 生活 (8筆) - 最近更新: 昨天 18:45
   標籤: #購物、#運動、#飲食

📁 想法 (15筆) - 最近更新: 3天前
   標籤: #靈感、#創意、#筆記

... (以下略)
```

### 場景 2: 生成主題摘要
```
你: 幫我整理一下工作主題的記憶
管家: 好的,讓我整理一下您的工作記憶~

📊 工作主題摘要

您在工作主題下記錄了 12 筆資訊,從 9/15 到今天。

重點項目:
• 專案 A deadline 在 11/15,需準備客戶簡報
• 每週一 10:00 固定團隊會議
• B 公司聯絡人是張經理(email: zhang@b.com)
• Q4 目標是提升 20% 轉換率

常用標籤: #專案 #會議 #客戶 #目標

💡 豪力殿下,距離專案 A 的 deadline 還有 3 週,要開始準備了喔!
```

### 場景 3: 更新記憶
```
你: 更新咖啡喜好,我現在改喝美式了
管家: 收到!我幫您更新「咖啡喜好」的內容~ 已經改成美式咖啡囉!下次我會記得的 ☕
```

### 場景 4: 統計分析
```
你: 統計一下我的記憶
管家: 好的豪力殿下,這是您的記憶統計:

📈 整體資訊
• 總記憶數: 45 筆
• 主題數: 7 個

🏷 熱門標籤 TOP 5:
1. #工作 (15次)
2. #想法 (12次)
3. #生活 (10次)
4. #專案 (8次)
5. #客戶 (6次)

看起來工作相關的記錄最多呢!需要我幫您整理工作主題嗎?
```

---

## 🚀 使用方式

### 1. 安裝依賴
```bash
pip install openai python-dotenv
```

### 2. 設定環境變數
創建 `.env` 檔案:
```
OPENAI_API_KEY=your_api_key_here
```

### 3. 執行程式
```bash
python agent_enhanced.py
```

---

## 📝 與原版的差異

| 功能 | 原版 | 增強版 |
|------|------|--------|
| 寫入記憶 | ✅ | ✅ |
| 讀取記憶 | ✅ | ✅ (支援標籤過濾) |
| 更新記憶 | ❌ | ✅ |
| 刪除記憶 | ❌ | ✅ |
| 列出主題 | ❌ | ✅ |
| 統計分析 | ❌ | ✅ |
| 主題摘要 | ❌ | ✅ (AI 自動生成) |
| 更新時間追蹤 | ❌ | ✅ |

---

## 🎨 系統提示詞更新

增強版的系統提示詞新增了以下指令:

3. **記憶更新** - 教導 AI 何時使用 update_memory
4. **記憶刪除** - 教導 AI 何時使用 delete_memory
5. **主題列表** - 教導 AI 如何展示主題列表
6. **統計資訊** - 教導 AI 如何呈現統計數據
7. **主題摘要** - 教導 AI 如何生成清晰的摘要報告

---

## 💡 進階使用建議

### 1. 定期整理記憶
- 每月使用 `list_topics` 查看所有主題
- 使用 `get_statistics` 了解記憶分佈
- 刪除不再需要的舊記憶

### 2. 善用標籤系統
- 使用一致的標籤命名(如 #工作、#生活)
- 一個記憶可以有多個標籤
- 透過標籤快速過濾相關記憶

### 3. 生成定期報告
- 每週生成工作主題摘要
- 月底統計整體記憶使用情況
- 根據摘要內容調整下個月的計畫

---

## 🔮 未來可能的擴充

1. **時間範圍查詢** - 查詢特定時間段的記憶
2. **記憶匯出** - 匯出為 Markdown 或 PDF
3. **智慧提醒** - 根據 deadline 自動提醒
4. **記憶關聯** - 建立記憶之間的連結
5. **多使用者支援** - 支援多個使用者各自的記憶庫
6. **雲端同步** - 將記憶同步到雲端儲存

---

## 📞 需要協助?

如果在使用過程中遇到問題,可以:
- 直接問利娜莉:「教我怎麼用新功能」
- 檢查 `memory_store.json` 檔案結構
- 查看終端機的錯誤訊息

---

祝您使用愉快! ✨
利娜莉會成為您最棒的個人管家 💝
